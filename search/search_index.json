{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Re:Bloom Tech Notes","text":"<p>Re:Bloom\uc740 \uc0dd\uc874\u00b7\uac70\uc810 \uc131\uc7a5(\uac74\ucd95/\ub18d\uc0ac/\uc81c\uc791) \uc911\uc2ec\uc758 \ud06c\ub85c\uc2a4\ud50c\ub7ab\ud3fc \uac8c\uc784\uc785\ub2c8\ub2e4. \uc800\ub294 \ucf54\uc5b4 \uc2dc\uc2a4\ud15c \uc124\uacc4\u00b7\uad6c\ud604\uacfc \ub370\uc774\ud130 \uae30\ubc18 \uc6b4\uc601 \uad6c\uc870, \uc138\uc774\ube0c/\ub85c\ub4dc\u00b7UI \uacf5\ud1b5 \uae30\ubc18\u00b7\ucd5c\uc801\ud654\uae4c\uc9c0 \uc804\ubc18\uc801\uc778 \uae30\uc220 \uae30\ubc18\uc744 \uad6c\ucd95\ud588\uc2b5\ub2c8\ub2e4.</p>"},{"location":"#quick-links","title":"Quick Links","text":"<ul> <li>Quest &amp; Tutorial \u2014 \ud018\uc2a4\ud2b8 \uc870\uac74 \ud0c0\uc785/\uae38\uc548\ub0b4/\uc5d4\ub529 \ucef7\uc52c/\ub179\uc9c0\ud654 \uc5f0\ub3d9</li> <li>Building System \u2014 \uc5f0\uacb0\ud615/\uc790\uc720\ubc30\uce58, \uaddc\uce59 \uac80\uc0ac, \ud3b8\uc9d1 \ubaa8\ub4dc, \ud504\ub9ac\ud339 \uc790\ub3d9 \ubcf4\uc815</li> <li>Farming System \u2014 FarmBed(\uc2ac\ub86f \uc131\uc7a5) + \uc628\uc2e4 \uc5c5\uadf8\ub808\uc774\ub4dc \uae30\ubc18 \uc790\ub3d9\ud654(\uc2a4\ud504\ub9c1\ud074\ub7ec/\ub4dc\ub860)</li> <li>Save/Load &amp; Server \u2014 \ub85c\uceec\u2194\uc11c\ubc84 \uc790\ub3d9 \uc804\ud658 + PlayFab</li> <li>UI Framework \u2014 UIBase + UIManager(\uc785\ub825/\uacb9\uce68 \uc81c\uc5b4) + \ud1a0\uc2a4\ud2b8</li> <li>Optimization \u2014 \uba54\ubaa8\ub9ac/\ubcd1\ubaa9 \ubd84\uc11d + URP \ubd84\ub9ac + \ud234\ub9c1</li> <li>Repo &amp; Automation \u2014 LFS/filter-repo + Linear\u2192OpenAI\u2192Notion \uc790\ub3d9 \ubcf4\uace0</li> </ul>"},{"location":"data-pipeline/","title":"Data Pipeline (BG DB)","text":""},{"location":"data-pipeline/#goal","title":"Goal","text":"<p>Re:Bloom\uc740 \uc544\uc774\ud15c\u00b7\ud018\uc2a4\ud2b8\u00b7\uac74\ucd95\u00b7\ub18d\uc0ac\u00b7\uc2a4\ud0ef \ub4f1 \uc2dc\uc2a4\ud15c\uc774 \ub9ce\uace0, \ubc38\ub7f0\uc2a4/\ucf58\ud150\uce20\uac00 \ube60\ub974\uac8c \ubc14\ub00c\ub294 \ud504\ub85c\uc81d\ud2b8\uc785\ub2c8\ub2e4. \uc774\ub97c \ucf54\ub4dc \uc218\uc815 \uc5c6\uc774 \ud655\uc7a5\u00b7\uc6b4\uc601\ud560 \uc218 \uc788\ub3c4\ub85d BG Database \uae30\ubc18\uc758 \ub370\uc774\ud130 \ud14c\uc774\ube14 \ud30c\uc774\ud504\ub77c\uc778\uc744 \uad6c\ucd95\ud588\uc2b5\ub2c8\ub2e4.</p> <ul> <li>\uae30\ud68d/\uc6b4\uc601 \ub370\uc774\ud130\ub294 \ud14c\uc774\ube14\uc5d0\uc11c \uad00\ub9ac</li> <li>\ub7f0\ud0c0\uc784\uc5d0 \ud14c\uc774\ube14\uc744 \ub85c\ub529\ud574 \uc2dc\uc2a4\ud15c\uc5d0 \uc8fc\uc785</li> <li>\uc2dc\uc2a4\ud15c\uc740 \u201c\ub370\uc774\ud130\ub97c \uc77d\uc5b4 \ub3d9\uc791\u201d\ud558\ub3c4\ub85d \uc124\uacc4\ud558\uc5ec \ucf58\ud150\uce20 \ud655\uc7a5 \ube44\uc6a9\uc744 \ucd5c\uc18c\ud654</li> </ul>"},{"location":"data-pipeline/#system-overview","title":"System Overview","text":""},{"location":"quest/","title":"Quest & Tutorial","text":""},{"location":"quest/#goal","title":"Goal","text":"<p>\ud29c\ud1a0\ub9ac\uc5bc\ubd80\ud130 \uba54\uc778 \ud018\uc2a4\ud2b8, \ucd5c\uc885 \uc5d4\ub529 \ucef7\uc52c\uae4c\uc9c0 \ud50c\ub808\uc774 \uacbd\ud5d8\uc774 \ub04a\uae30\uc9c0 \uc54a\ub3c4\ub85d \ud018\uc2a4\ud2b8 \uc9c4\ud589\uc744 \ub370\uc774\ud130 \uae30\ubc18(\uc870\uac74 \ud0c0\uc785/\ubaa9\uc801\uc9c0/\ubcf4\uc0c1)\uc73c\ub85c \uc124\uacc4\ud558\uace0, \uac01 \uc870\uac74\uc744 \uc0c1\ud638\uc791\uc6a9 \uc2dc\uc2a4\ud15c\uacfc \uc5f0\uacb0\ud574 \ud655\uc7a5 \uac00\ub2a5\ud55c \uad6c\uc870\ub85c \uad6c\ud604\ud588\uc2b5\ub2c8\ub2e4.</p>"},{"location":"quest/#system-overview","title":"System Overview","text":""},{"location":"save-load/","title":"Save/Load & Server","text":""},{"location":"save-load/#goal","title":"Goal","text":"<p>\ud06c\ub85c\uc2a4\ud50c\ub7ab\ud3fc \ud658\uacbd\uc5d0\uc11c \ud50c\ub808\uc774 \ub370\uc774\ud130\uac00 \uc548\uc815\uc801\uc73c\ub85c \uc720\uc9c0\ub418\ub3c4\ub85d \ub85c\uceec \uc800\uc7a5\uc744 \uae30\ubcf8\uc73c\ub85c \ud558\ub418, \ub85c\uadf8\uc778/\ub124\ud2b8\uc6cc\ud06c \uc870\uac74\uc774 \ucda9\uc871\ub418\uba74 PlayFab \uc11c\ubc84 \uc800\uc7a5\uc73c\ub85c \uc790\ub3d9 \uc804\ud658\ub418\ub294 \ud558\uc774\ube0c\ub9ac\ub4dc Save/Load \uad6c\uc870\ub97c \uc124\uacc4\ud588\uc2b5\ub2c8\ub2e4.</p>"},{"location":"save-load/#system-overview","title":"System Overview","text":""},{"location":"building/","title":"Overview","text":""},{"location":"building/#goal","title":"Goal","text":"<p>\uac70\uc810 \uc131\uc7a5\uc758 \uc911\uc2ec\uc778 \uac74\ucd95\uc744 \uc5f0\uacb0\ud615(\ud1b5\ub85c/\uc628\uc2e4) + \uc790\uc720\ubc30\uce58\ud615(\uc2dc\uc124/\uc7a5\uce58) \ubaa8\ub450 \uc9c0\uc6d0\ud558\ub3c4\ub85d \uc124\uacc4\ud588\uc2b5\ub2c8\ub2e4. \uc124\uce58 \uacfc\uc815\uc5d0\uc11c \uaddc\uce59/\uc870\uac74 \uac80\uc99d\uc744 \ud1b5\ud574 \uc2e4\ud328\ub97c \uba85\ud655\ud788 \uc548\ub0b4\ud558\uace0, \ud504\ub9ac\ud339\uc758 \uc88c\ud45c/\uc2a4\ucf00\uc77c/\ucda9\ub3cc \ubb38\uc81c\ub97c \uc790\ub3d9 \ubcf4\uc815\ud574 \uc124\uce58 \uc548\uc815\uc131\uc744 \ud655\ubcf4\ud588\uc2b5\ub2c8\ub2e4. \ub610\ud55c \uc124\uce58\ub41c \uac74\ucd95\ubb3c\uc740 \uc5f0\uad6c\u00b7\uc804\ub825\u00b7\ub179\uc9c0\ud654 \ub4f1 \uac70\uc810 \ud575\uc2ec \uc218\uce58\uc640 \uc5f0\ub3d9\ub418\uc5b4 \uc131\uc7a5 \ub8e8\ud504\ub97c \uc644\uc131\ud569\ub2c8\ub2e4.</p>"},{"location":"building/#system-overview","title":"System Overview","text":"<p>BuildPlacementController: \u201c\ud504\ub9ac\ubdf0/\uc2a4\ub0c5/\ud655\uc815/\ucde8\uc18c/\ud3b8\uc9d1\ubaa8\ub4dc \uc785\ub825\u201d</p> <p>BuildManager: \u201c\uac80\uc99d \u2192 \uc790\ub3d9\ubcf4\uc815 \u2192 \uc2a4\ud3f0 \u2192 \uc810\uc720/\uc5f0\uacb0 \ub4f1\ub85d \u2192 \uc800\uc7a5/\ud018\uc2a4\ud2b8\u201d</p> <p>BuildingInstance: \u201c\uc0dd\uba85\uc8fc\uae30(OnEnable/Disable)\uc5d0\uc11c \ub4f1\ub85d/\ud574\uc81c \uc790\ub3d9\ud654\u201d</p> <p>IBuildRule: \u201c\uaddc\uce59\uc744 \ubaa8\ub4c8\ub85c \ubd84\ub9ac\ud574\uc11c \uc870\ud569 \uac00\ub2a5(Flat/Collision/Limit/Attach/Cell/Occupancy\u2026)\u201d</p>"},{"location":"building/corridor/","title":"Corridor Connection","text":""},{"location":"building/corridor/#goal","title":"Goal","text":"<p><code>CorridorNode</code>\uc758 Cell \uae30\ubc18\uc73c\ub85c \u201c\ubd99\uc774\uae30/\uc5f0\uacb0\u201d\uc744 \uc608\uce21 \uac00\ub2a5\ud558\uac8c \ub9cc\ub4e0\ub2e4.</p>"},{"location":"building/corridor/#key-idea","title":"Key Idea","text":"<ul> <li>\ud788\ud2b8\ud55c \ud1b5\ub85c\uc758 <code>Cell</code> + \ub9de\ucd98 \uba74 \ubc29\ud5a5\uc73c\ub85c <code>targetCell</code>\uc744 \uacc4\uc0b0\ud574, \u201c\uc5b4\ub514\uc5d0 \ubd99\ub294\uc9c0\u201d\uac00 \ud56d\uc0c1 \ub3d9\uc77c \uaddc\uce59\uc73c\ub85c \uacb0\uc815\ub41c\ub2e4.</li> <li><code>CellToWorldCenter()</code>\ub85c \uc140 \uc911\uc2ec \uc2a4\ub0c5\uc744 \uc801\uc6a9\ud574 \uc790\uc5f0\uc2a4\ub7ec\uc6b4 \ubc30\uce58 UX\ub97c \ub9cc\ub4e0\ub2e4.</li> <li>\uc18c\ucf13/\uc5f0\uacb0 \ub9e4\ub2c8\uc800(<code>CorridorSocketManager</code> \ub4f1)\ub85c \uc5f0\uacb0 \uc0c1\ud0dc\ub97c \uc2dc\uc2a4\ud15c\uc801\uc73c\ub85c \uad00\ub9ac\ud55c\ub2e4.</li> </ul>"},{"location":"building/corridor/#snippet-a-targetcell","title":"Snippet A \u2014 \uae30\uc874 \ud1b5\ub85c \ud788\ud2b8 \u2192 targetCell \uacc4\uc0b0","text":"<pre><code>Vector2Int baseCell = hitNode.Cell;\n\nVector3 localHit = hitNode.transform.InverseTransformPoint(hit.point);\nCorridorDirection localDir =\n    (Mathf.Abs(localHit.x) &gt; Mathf.Abs(localHit.z))\n    ? (localHit.x &gt; 0 ? CorridorDirection.East : CorridorDirection.West)\n    : (localHit.z &gt; 0 ? CorridorDirection.North : CorridorDirection.South);\n\nCorridorDirection worldDir =\n    CorridorConnectionManager.RotateDirection(localDir, baseRotIndex);\n\nVector2Int targetCell =\n    baseCell + CorridorConnectionManager.DirectionToOffset(worldDir);\n\npos = CorridorGrid.CellToWorldCenter(targetCell, hitNode.transform.position.y);\nrot = hitNode.transform.rotation; \n</code></pre>"},{"location":"building/corridor/#snippet-b-registerbuilding","title":"Snippet B \u2014 RegisterBuilding\uc5d0\uc11c \uc18c\ucf13 \ub4f1\ub85d","text":"<pre><code>var sp = inst.GetComponent&lt;CorridorSocketProvider&gt;();\nif (sp != null)\n{\n    int rotIndex = CorridorGrid.GetRotIndex(inst.transform.rotation);\n    Vector2Int baseCell = CorridorGrid.WorldToCell(inst.transform.position);\n    CorridorSocketManager.I?.RegisterSockets(sp, baseCell, rotIndex);\n}\n</code></pre>"},{"location":"building/edit_mode/","title":"Edit Mode","text":""},{"location":"building/edit_mode/#goal","title":"Goal","text":"<p>\uac70\uc810 \uc131\uc7a5\uc758 \uc911\uc2ec\uc778 \uac74\ucd95\uc744 \uc5f0\uacb0\ud615(\ud1b5\ub85c/\uc628\uc2e4) + \uc790\uc720\ubc30\uce58\ud615(\uc2dc\uc124/\uc7a5\uce58) \ubaa8\ub450 \uc9c0\uc6d0\ud558\ub3c4\ub85d \uc124\uacc4\ud588\uc2b5\ub2c8\ub2e4. \uc124\uce58 \uacfc\uc815\uc5d0\uc11c \uaddc\uce59/\uc870\uac74 \uac80\uc99d\uc744 \ud1b5\ud574 \uc2e4\ud328\ub97c \uba85\ud655\ud788 \uc548\ub0b4\ud558\uace0, \ud504\ub9ac\ud339\uc758 \uc88c\ud45c/\uc2a4\ucf00\uc77c/\ucda9\ub3cc \ubb38\uc81c\ub97c \uc790\ub3d9 \ubcf4\uc815\ud574 \uc124\uce58 \uc548\uc815\uc131\uc744 \ud655\ubcf4\ud588\uc2b5\ub2c8\ub2e4. \ub610\ud55c \uc124\uce58\ub41c \uac74\ucd95\ubb3c\uc740 \uc5f0\uad6c\u00b7\uc804\ub825\u00b7\ub179\uc9c0\ud654 \ub4f1 \uac70\uc810 \ud575\uc2ec \uc218\uce58\uc640 \uc5f0\ub3d9\ub418\uc5b4 \uc131\uc7a5 \ub8e8\ud504\ub97c \uc644\uc131\ud569\ub2c8\ub2e4.</p>"},{"location":"building/edit_mode/#system-overview","title":"System Overview","text":""},{"location":"building/ground_snap/","title":"Ground Snap (Auto Adjust)","text":""},{"location":"building/ground_snap/#goal","title":"Goal","text":"<p>\u201c\ubc14\ub2e5/\uacbd\uc0ac/\ud30c\ubb3b\ud798\u201d \ubb38\uc81c\ub97c \uc790\ub3d9 \ubcf4\uc815\ud574 \uc124\uce58 \uc548\uc815\uc131\uc744 \ud655\ubcf4\ud55c\ub2e4.</p>"},{"location":"building/ground_snap/#key-idea","title":"Key Idea","text":"<ul> <li>footprint 4\ucf54\ub108 + center \ub808\uc774\uce90\uc2a4\ud2b8\ub85c \u201c\uc2e4\uc81c \uc9c0\uba74\u201d\uc744 \uc0d8\ud50c\ub9c1\ud55c\ub2e4.</li> <li>maxHeightDiff\ub85c \uacbd\uc0ac/\ub2e8\ucc28\ub97c \uc81c\ud55c\ud574 \uc124\uce58 \ubd88\uac00 \uc870\uac74\uc744 \uba85\ud655\ud788 \ub9cc\ub4e0\ub2e4.</li> <li>DepthOffset\uc73c\ub85c \ud504\ub9ac\ud339\ubcc4 \ud30c\ubb3b\ud798/\ub738\uc744 \ubcf4\uc815\ud574 \ucd5c\uc885 Y\ub97c \uc548\uc815\ud654\ud55c\ub2e4.</li> </ul>"},{"location":"building/ground_snap/#snippet-tryadjusttoground","title":"Snippet \u2014 TryAdjustToGround (\ud575\uc2ec)","text":"<pre><code>float minY = float.MaxValue, maxY = float.MinValue;\nint hitCount = 0;\n\nfor (int i = 0; i &lt; localOffsets.Length; i++)\n{\n    Vector3 worldPos = center + rot * localOffsets[i] + Vector3.up * 5f;\n    if (Physics.Raycast(worldPos, Vector3.down, out var hit, 20f, buildableLayer))\n    {\n        hitCount++;\n        minY = Mathf.Min(minY, hit.point.y);\n        maxY = Mathf.Max(maxY, hit.point.y);\n    }\n}\n\nif (hitCount == 0) { errorCode = \"NO_GROUND\"; return false; }\nif ((maxY - minY) &gt; maxHeightDiff) { errorCode = \"SLOPE_TOO_HIGH\"; return false; }\n\nadjustedPos = new Vector3(center.x, maxY - ctx.DepthOffset, center.z);\n</code></pre>"},{"location":"building/integration/","title":"Integrations","text":""},{"location":"building/integration/#goal","title":"Goal","text":"<p>\uac74\ucd95\uc744 \u201c\ub2e8\ub3c5 \uae30\ub2a5\u201d\uc774 \uc544\ub2c8\ub77c \uc131\uc7a5 \ub8e8\ud504(\uc7ac\ub8cc/\ud018\uc2a4\ud2b8/\uc138\uc774\ube0c)\uc640 \uc5f0\uacb0\ud55c\ub2e4.</p>"},{"location":"building/integration/#key-idea","title":"Key Idea","text":"<ul> <li>\ub808\uc2dc\ud53c \uae30\ubc18 \uc7ac\ub8cc \uac80\uc99d/\uc18c\ubaa8\ub85c \uc124\uce58 UX\ub97c \uc77c\uad00\ub418\uac8c \uc720\uc9c0\ud55c\ub2e4.</li> <li>\uc124\uce58 \uc644\ub8cc \uc2dc <code>QuestManager</code>\uc5d0 \ud1b5\uc9c0\ud574 \ud018\uc2a4\ud2b8 \uc9c4\ud589\uacfc \uc989\uc2dc \uc5f0\uacb0\ud55c\ub2e4.</li> <li>\uc124\uce58/\uc774\ub3d9/\uc0ad\uc81c \uc2dc <code>AutoSaveService.RequestSave()</code>\ub85c \uc9c4\ud589 \ubcf4\uc874\uc744 \uc790\ub3d9\ud654\ud55c\ub2e4.</li> </ul>"},{"location":"building/integration/#snippet-a-trybuild","title":"Snippet A \u2014 TryBuild \uc7ac\ub8cc \uccb4\ud06c/\uc18c\ubaa8","text":"<pre><code>if (!recipeDB.TryGetRecipe(arcId, out var recipe))\n    return Spawn(arc, pos, rot);\n\nif (!debugBuildingMode)\n{\n    if (!HasMaterials(recipe))\n    {\n        ToastMessageUI.Instance.Show(\"\uc7ac\ub8cc\uac00 \ubd80\uc871\ud569\ub2c8\ub2e4.\");\n        return false;\n    }\n    Remove(recipe);\n}\n\nreturn Spawn(arc, pos, rot);\n</code></pre>"},{"location":"building/integration/#snippet-b-spawn","title":"Snippet B \u2014 Spawn \ub9c8\ubb34\ub9ac(\ud018\uc2a4\ud2b8 + \uc800\uc7a5)","text":"<pre><code>QuestManager.I?.NotifyBuildingBuilt(arc.arcId);\nAutoSaveService.I?.RequestSave(\"Build\");\nreturn true;\n</code></pre>"},{"location":"building/occupancy/","title":"Grid Occupancy","text":""},{"location":"building/occupancy/#goal","title":"Goal","text":"<p>footprint \uae30\ubc18 \uc140 \uc810\uc720\ub85c \u201c\uacb9\uce68/\uc911\ubcf5 \uc124\uce58\u201d\ub97c \uc2dc\uc2a4\ud15c\uc801\uc73c\ub85c \ucc28\ub2e8\ud55c\ub2e4.</p>"},{"location":"building/occupancy/#key-idea","title":"Key Idea","text":"<ul> <li>footprint \u2192 \uc140 \uc601\uc5ed \uacc4\uc0b0 \u2192 <code>GridOccupancyManager.Occupy</code> \ud750\ub984\uc73c\ub85c \u201c\uc774\ubbf8 \uc810\uc720\ub41c \uacf5\uac04\u201d\uc5d0 \ub300\ud55c \uc124\uce58\ub97c \uc6d0\ucc9c \ucc28\ub2e8\ud55c\ub2e4.</li> <li>\uc774\ub3d9/\uc0ad\uc81c \uc2dc\uc5d0\ub3c4 Release \u2192 Occupy \uc7ac\uc801\uc6a9\uc73c\ub85c \uc810\uc720 \uc0c1\ud0dc\ub97c \ud56d\uc0c1 \uc77c\uad00\ub418\uac8c \uc720\uc9c0\ud55c\ub2e4.</li> </ul>"},{"location":"building/occupancy/#snippet-a-footprint-cells","title":"Snippet A \u2014 footprint \u2192 cells","text":"<pre><code>Vector2Int baseCell = CorridorGrid.WorldToCell(pos);\nint hx = sx / 2, hz = sz / 2;\n\nfor (int x = -hx; x &lt; -hx + sx; x++)\n    for (int z = -hz; z &lt; -hz + sz; z++)\n        yield return new Vector2Int(baseCell.x + x, baseCell.y + z);\n</code></pre>"},{"location":"building/occupancy/#snippet-b-spawn","title":"Snippet B \u2014 Spawn()\uc5d0\uc11c \uc810\uc720 \ub4f1\ub85d","text":"<pre><code>var fp = footprintProvider.GetFootprint(arc);\nvar cells = GetCellsFromFootprint(fp, p.transform.position, p.transform.rotation);\n\nGridOccupancyManager.I?.Occupy(bInstance, cells);\nAutoSaveService.I?.RequestSave(\"Build\");\n</code></pre>"},{"location":"building/placement/","title":"Placement & Preview","text":""},{"location":"building/placement/#goal","title":"Goal","text":"<ul> <li>\u201c\uc785\ub825/\ud504\ub9ac\ubdf0/\ud3b8\uc9d1\u201d\uc740 Controller, \u201c\uac80\uc99d/\uc0dd\uc131\u201d\uc740 Manager\uac00 \ub2f4\ub2f9\ud55c\ub2e4.</li> </ul>"},{"location":"building/placement/#key-idea","title":"Key Idea","text":"<ul> <li>\ucc45\uc784 \ubd84\ub9ac: \uc124\uce58 \uc785\ub825/\ud504\ub9ac\ubdf0/\ucde8\uc18c/\ud3b8\uc9d1 \uc785\ub825\uc740 <code>BuildPlacementController</code>, \uc2e4\uc81c \uac80\uc99d/\uc0dd\uc131\uc740 <code>BuildManager</code>\ub85c \uc704\uc784.</li> <li>\uc5f0\uacb0\ud615 \uc2a4\ub0c5: \ud1b5\ub85c\ub294 \u201c\uae30\uc874 \ub178\ub4dc \ud788\ud2b8 \uc2dc\u201d \uc140 \ub2e8\uc704 \uc2a4\ub0c5 + 90\ub3c4 \ud68c\uc804 \uc2a4\ub0c5\uc73c\ub85c \uc5f0\uacb0 UX\ub97c \uc548\uc815\ud654.</li> <li>\uac80\uc99d \uc7ac\uc0ac\uc6a9: \uc774\ub3d9\ub3c4 <code>CanMoveAt \u2192 TryMoveBuilding</code>\uc73c\ub85c \uc124\uce58 \uac80\uc99d \ud30c\uc774\ud504\ub77c\uc778\uc744 \uc7ac\uc0ac\uc6a9.</li> </ul>"},{"location":"building/placement/#snippet-canbuildat","title":"Snippet \u2014 \u201c\ud504\ub9ac\ubdf0 \ub8e8\ud504 + CanBuildAt \uc704\uc784\u201d","text":"<pre><code>if (isPlacing &amp;&amp; currentArc != null &amp;&amp; previewInstance != null)\n{\n    GetTargetTransform(out var pos, out var rot);\n\n    previewInstance.transform.SetPositionAndRotation(pos, rot);\n\n    lastCanBuild = BuildManager.I.CanBuildAt(currentArc, pos, rot, out lastError);\n    previewVisual?.SetValid(lastCanBuild);\n\n    HandleInput(pos, rot);\n    return;\n}\n</code></pre>"},{"location":"building/validation/","title":"Validation Rules","text":""},{"location":"building/validation/#goal","title":"Goal","text":"<p>\uaddc\uce59\uc744 \ubaa8\ub4c8\ub85c \uc870\ud569\ud558\uace0, \uc2e4\ud328 \uc6d0\uc778\uc744 \ud45c\uc900\ud654\ud574 UI \uc548\ub0b4\uac00 \uba85\ud655\ud574\uc9c4\ub2e4.</p>"},{"location":"building/validation/#key-idea","title":"Key Idea","text":"<ul> <li><code>IBuildRule</code> \ub9ac\uc2a4\ud2b8\ub85c \uaddc\uce59\uc744 \uc870\ud569\ud574 \ud655\uc7a5 \uac00\ub2a5(\ucd94\uac00/\uc0ad\uc81c).</li> <li><code>Validate(ctx, out errorCode)</code>\ub85c \uc2e4\ud328 \uc0ac\uc720\ub97c \ud55c \ucc44\ub110\ub85c \ud45c\uc900\ud654 \u2192 Toast/UI \uba54\uc2dc\uc9c0 \uc77c\uad00.</li> </ul>"},{"location":"building/validation/#evidence-code","title":"Evidence (Code)","text":""},{"location":"building/validation/#snippet-a-initrules","title":"Snippet A \u2014 InitRules()","text":"<pre><code>private void InitRules()\n{\n    buildRules.Add(new FlatSurfaceRule(buildableLayer, maxHeightDiff, maxSlopeAngle));\n    buildRules.Add(new CollisionRule(obstacleLayer));\n    buildRules.Add(new LimitRule(this));\n    buildRules.Add(new CorridorAttachRule());\n    buildRules.Add(new CorridorCellRule());\n    buildRules.Add(new OccupancyRule());\n}\n</code></pre>"},{"location":"building/validation/#snippet-b-validate","title":"Snippet B \u2014 Validate()","text":"<pre><code>public bool Validate(ArcContext ctx, out string errorCode)\n{\n    foreach (var rule in buildRules)\n        if (!rule.Validate(ctx, out errorCode))\n            return false;\n\n    errorCode = null;\n    return true;\n}\n</code></pre>"},{"location":"farming/","title":"Overview","text":""},{"location":"farming/#goal","title":"Goal","text":"<p>\ub18d\uc0ac \ub8e8\ud504(\uc2ec\uae30 \u2192 \uc131\uc7a5 \u2192 \ubb3c/\ube44\ub8cc \u2192 \uc218\ud655)\ub97c \uc2ac\ub86f \ub2e8\uc704 \uc0c1\ud0dc\uba38\uc2e0\uc73c\ub85c \uc548\uc815\uc801\uc73c\ub85c \uc6b4\uc601\ud55c\ub2e4. \uc131\uc7a5 \uaddc\uce59(\uc2dc\uac04/\ubb3c \uc694\uad6c/\ub2e8\uacc4 \uc804\ud658)\uc744 FarmDB \ub370\uc774\ud130\ub85c \ubd84\ub9ac\ud574 \u201c\uc791\ubb3c \ucd94\uac00 = \ud14c\uc774\ube14 \ucd94\uac00\u201d \uc911\uc2ec\uc73c\ub85c \ud655\uc7a5\ud55c\ub2e4. \ube44\uc8fc\uc5bc\uc740 Addressables\ub85c \ub85c\ub529\ud558\ub418, \ub2e8\uacc4 \uc804\ud658\uc774 \uc7a6\uc544\ub3c4 \ucde8\uc18c \ud1a0\ud070\uc73c\ub85c \uc911\ubcf5 \ub85c\ub529/\uacbd\ud569\uc744 \ubc29\uc9c0\ud55c\ub2e4. UI/\uc0c1\ud638\uc791\uc6a9\uc740 OnChanged \uc774\ubca4\ud2b8\ub85c \uc5f0\uacb0\ud574 \ub85c\uc9c1 \u2194 UI \uacb0\ud569\ub3c4\ub97c \ub0ae\ucd98\ub2e4.</p>"},{"location":"farming/#system-overview","title":"System Overview","text":"<p>FarmBed: 8\uac1c \uc2ac\ub86f Tick / API \uc81c\uacf5(Plant/Water/Fertilize/Harvest/Uproot)</p> <p>CropSlot: \uc2ac\ub86f \uc0c1\ud0dc \ub370\uc774\ud130(\uc791\ubb3cID, stageIndex, stageTimer, wateredCount, fertilizerRemain, multiplier\u2026)</p> <p>FarmDB: cropId \u2192 stages(needTime, needWater, prefabKey) \ub370\uc774\ud130 \uc81c\uacf5</p> <p>FarmPrefabProvider(Addressables): prefabKey\ub85c \ub2e8\uacc4 \ube44\uc8fc\uc5bc instantiate/release</p> <p>UI(SeedList/SlotHighlight \ub4f1): FarmBed.OnChanged \uad6c\ub3c5\ud574\uc11c \ud45c\uc2dc\ub9cc \uac31\uc2e0</p> <p>FarmBed\uac00 \u201c\uc0c1\ud0dc(\uc2ac\ub86f)\u201d\ub97c Tick\ud558\uace0, DB\ub85c \u201c\uaddc\uce59\u201d\uc744 \uac00\uc838\uc640 \uc9c4\ud589\uc2dc\ud0a4\uace0, \ube44\uc8fc\uc5bc/UI\ub294 \uc774\ubca4\ud2b8\ub85c \ub530\ub77c\uc624\uac8c \ub9cc\ub4e0 \uad6c\uc870</p>"},{"location":"farming/cultivationmachine/","title":"Cultivation Machine","text":""},{"location":"farming/cultivationmachine/#goal","title":"Goal","text":"<ul> <li> <p>FarmBed(\ub2e4\uc2ac\ub86f)\uc640 \ub2e4\ub978 \ud0c0\uc785\uc758 \u201c\ub18d\uc0ac \uc0dd\uc0b0 \uc124\ube44\u201d\ub97c \ub2e8\uc77c \uc2ac\ub86f \uc0c1\ud0dc\uba38\uc2e0\uc73c\ub85c \uad6c\ud604</p> </li> <li> <p>\uc2dc\uc791 \uc870\uac74(\uc804\ub825/\uc544\uc774\ud15c \uc720\ud6a8\uc131)\uacfc \uacb0\uacfc \uc218\uac70\ub97c \uba85\ud655\ud788 \ubd84\ub9ac</p> </li> </ul>"},{"location":"farming/cultivationmachine/#key-idea","title":"Key Idea","text":"<ul> <li> <p>CanStart()\uc5d0\uc11c \uc2e4\ud328 \uc0ac\uc720(reason) \uc81c\uacf5</p> </li> <li> <p>Tick()\uc740 Running \uc0c1\ud0dc + \uc804\ub825 \uc870\uac74\uc5d0\uc11c\ub9cc \uc2dc\uac04 \uac10\uc18c</p> </li> <li> <p>\uc644\ub8cc \uc2dc ReadyToCollect \u2192 Collect\ub85c \uc778\ubca4 \ubc18\uc601 \ud6c4 \uc2ac\ub86f \ucd08\uae30\ud654</p> </li> </ul>"},{"location":"farming/farmingautomation/","title":"Automation","text":""},{"location":"farming/farmingautomation/#goal","title":"Goal","text":"<ul> <li> <p>\uc790\ub3d9\ud654 \uc7a5\uce58(\uc2a4\ud504\ub9c1\ud074\ub7ec/\ub4dc\ub860)\ub97c \u201c\ub18d\uc0ac \ub85c\uc9c1\u201d\uacfc \ubd84\ub9ac\ud558\uace0, \uc5c5\uadf8\ub808\uc774\ub4dc \ud574\uae08 \uc2dc \ub3c5\ub9bd \uc2dc\uc2a4\ud15c\uc744 \ud65c\uc131\ud654\ud558\ub294 \ubc29\uc2dd\uc73c\ub85c \ud655\uc7a5\ud55c\ub2e4.</p> </li> <li> <p>\uc790\ub3d9\ud654\ub294 FarmBed API\ub9cc \uc0ac\uc6a9\ud574 \uae30\uc874 \ub85c\uc9c1 \uc218\uc815 \uc5c6\uc774 \ucd94\uac00\ub418\uac8c \ud55c\ub2e4.</p> </li> </ul>"},{"location":"farming/farmingautomation/#system-overview","title":"System Overview","text":"<p>GreenhouseUpgradeService</p> <ul> <li> <p>IsUnlocked/CanPurchase/Purchase\ub85c \uc5c5\uadf8\ub808\uc774\ub4dc \uad6c\ub9e4 \ucc98\ub9ac(\ube44\uc6a9 \ucc28\uac10 + \ub864\ubc31)</p> </li> <li> <p>Apply()\uc5d0\uc11c \uae30\ub2a5\ubcc4 \uc2dc\uc2a4\ud15c \ud65c\uc131\ud654/\uc124\uc815</p> </li> </ul> <p>GreenhouseSprinklerSystem</p> <ul> <li>\uc8fc\uae30\uc801\uc73c\ub85c FarmBed.CanWater \uac80\uc0ac \u2192 FarmBed.Water \ud638\ucd9c</li> </ul> <p>GreenhouseFarmDroneSystem</p> <ul> <li>\uc790\ub3d9 \uc218\ud655/\uc790\ub3d9 \ube44\ub8cc \uac19\uc740 \uae30\ub2a5\uc744 \ud1a0\uae00\ub85c \ud655\uc7a5 (SetAutoFertilize(true))</li> </ul>"},{"location":"farming/farmingautomation/#snippet-apply","title":"Snippet \u2014 Apply\uc758 \uc758\ubbf8","text":"<pre><code>case 2: // \uc2a4\ud504\ub9c1\ud074\ub7ec \uc124\uce58\n    ctx.GetComponentInChildren&lt;GreenhouseSprinklerSystem&gt;(true)?.gameObject.SetActive(true);\n    break;\n\ncase 4: // \ub18d\uc0ac\uc6a9 \ub4dc\ub860 \uc124\uce58\n    ctx.GetComponentInChildren&lt;GreenhouseFarmDroneSystem&gt;(true)?.gameObject.SetActive(true);\n    break;\n\ncase 5: // \ub4dc\ub860 \uac15\ud654(\uc790\ub3d9 \ube44\ub8cc)\n    ctx.GetComponentInChildren&lt;GreenhouseFarmDroneSystem&gt;(true)?.SetAutoFertilize(true);\n    break;\n</code></pre> <ul> <li> <p>\uc5c5\uadf8\ub808\uc774\ub4dc \ub85c\uc9c1\uc740 \u201c\uad6c\ub9e4/\ud574\uae08/\uc801\uc6a9\u201d\ub9cc \ub2f4\ub2f9</p> </li> <li> <p>\uc2e4\uc81c \uc790\ub3d9\ud654 \ud589\ub3d9\uc740 \uac01 \uc2dc\uc2a4\ud15c \ud074\ub798\uc2a4\uac00 \ub2f4\ub2f9 \u2192 \uae30\ub2a5 \ucd94\uac00 = \ud074\ub798\uc2a4 \ucd94\uac00 + Apply switch \ud655\uc7a5(\ub610\ub294 \ub098\uc911\uc5d4 function\u2192handler \ub9f5\uc73c\ub85c \ub354 \uae54\ub054\ud558\uac8c)</p> </li> </ul>"},{"location":"farming/slotstatemachine/","title":"FarmBed","text":""},{"location":"farming/slotstatemachine/#goal","title":"Goal","text":"<p>Empty \u2192 Growing \u2192 Mature \u2192 Empty</p> <p>\uc804\ud658 \ud2b8\ub9ac\uac70</p> <ul> <li> <p>Plant: Empty \u2192 Growing</p> </li> <li> <p>Stage complete: stageIndex++ (\ub9c8\uc9c0\ub9c9\uc774\uba74 Mature)</p> </li> <li> <p>Harvest/Uproot: Mature/Growing \u2192 Empty</p> </li> </ul>"},{"location":"farming/slotstatemachine/#key-idea","title":"Key Idea","text":"<ul> <li> <p>\ubb3c \uc694\uad6c\ub7c9 \ubbf8\ub2ec\uc774\uba74 \uc2dc\uac04 \uc9c4\ud589 \uc911\ub2e8</p> </li> <li> <p>\ube44\ub8cc\ub294 duration \ub3d9\uc548 multiplier \uc801\uc6a9 \ud6c4 \uc790\ub3d9 \uc6d0\ubcf5</p> </li> </ul>"},{"location":"farming/slotstatemachine/#snippet-tickslot","title":"Snippet \u2014 TickSlot (\uc0c1\ud0dc \uc804\uc774\uc758 \ud575\uc2ec)","text":"<pre><code>if (slot.state != CropSlotState.Growing) return;\n\nvar stage = row.stages[slot.stageIndex];\n\n// \ubb3c \ubd80\uc871\uc774\uba74 \uc131\uc7a5 \uc815\uc9c0\nif (stage.needWater &gt; 0 &amp;&amp; slot.wateredCount &lt; stage.needWater)\n    return;\n\n// \ube44\ub8cc \ubc84\ud504 \uc9c0\uc18d\uc2dc\uac04 \ucc98\ub9ac\nif (slot.fertilizerRemain &gt; 0f) {\n    slot.fertilizerRemain -= dt;\n    if (slot.fertilizerRemain &lt;= 0f) {\n        slot.fertilizerRemain = 0f;\n        slot.growSpeedMultiplier = 1f;\n    }\n}\n\nslot.stageTimer += dt * Mathf.Max(1f, slot.growSpeedMultiplier);\n\nif (slot.stageTimer &gt;= stage.needTime) {\n    slot.stageTimer = 0f;\n    slot.wateredCount = 0;\n    slot.stageIndex++;\n\n    if (slot.stageIndex &gt;= row.stages.Length - 1)\n        slot.state = CropSlotState.Mature;\n\n    UpdateSlotVisual(index);\n    OnChanged?.Invoke();\n}\n</code></pre>"},{"location":"farming/slotstatemachine/#why-this-matters","title":"Why this matters","text":"<p>\u201c\uc131\uc7a5 \uaddc\uce59\u201d\uc774 Tick \uc548\uc5d0 \uace0\uc815\ub418\uc5b4 \uc788\uc5b4\ub3c4, \uc2e4\uc81c \uac12(needTime/needWater/prefabKey)\uc740 FarmDB\ub85c \uad50\uccb4 \uac00\ub2a5\ud574\uc11c \ucf58\ud150\uce20 \ud655\uc7a5\uc774 \uc26c\uc6c0.</p>"},{"location":"farming/slotstatemachine/#visual-loading-addressables-cancel","title":"Visual Loading (Addressables + Cancel)","text":"<p>\uc131\uc7a5 \ub2e8\uacc4\uac00 \ubc14\ub00c\uba74 prefabKey\uac00 \ubc14\ub00c\uae30 \ub54c\ubb38\uc5d0, \ub85c\ub529 \uacbd\uc7c1\uc774 \uc27d\uac8c \uc0dd\uae40 \u2192 \uc2ac\ub86f\ubcc4 CTS\ub85c \uc774\uc804 \ub85c\ub529 \ucde8\uc18c.</p>"},{"location":"farming/slotstatemachine/#snippet-updateslotvisualasync","title":"Snippet \u2014 UpdateSlotVisualAsync(\ud575\uc2ec)","text":"<p><pre><code>_slotCts[index]?.Cancel();\n_slotCts[index]?.Dispose();\n_slotCts[index] = new CancellationTokenSource();\nvar token = _slotCts[index].Token;\n\nif (slot.visualRoot != null) {\n    FarmPrefabProvider.I.ReleaseAddressableInstance(slot.visualRoot);\n    slot.visualRoot = null;\n    slot.visual = null;\n}\n\nvar go = await FarmPrefabProvider.I.InstantiateAddressableAsync(prefabKey, ...);\nif (token.IsCancellationRequested) {\n    if (go != null) FarmPrefabProvider.I.ReleaseAddressableInstance(go);\n    return;\n}\nslot.visualRoot = go;\nslot.visual = go.GetComponentInChildren&lt;CropVisual&gt;(true);\n</code></pre> \u201c\ub2e8\uc21c \ub85c\ub529\u201d\uc774 \uc544\ub2c8\ub77c \uc2a4\ud14c\uc774\uc9c0 \uc804\ud658/\ucde8\uc18c/\uc815\ub9ac(ReleaseInstance) \uae4c\uc9c0 \ud3ec\ud568\ud574 \uba54\ubaa8\ub9ac \ub204\uc218/\uc911\ubcf5 \uc778\uc2a4\ud134\uc2a4/\uacbd\ud569\uc744 \ubc29\uc9c0\ud588\ub2e4.</p>"},{"location":"farming/slotstatemachine/#external-api-playerautomation","title":"External API (Player/Automation \uacf5\uc6a9)","text":"<ul> <li> <p>CanPlant/Plant</p> </li> <li> <p>CanWater/Water, TryWaterByPlayer(\uc778\ubca4 \uc18c\ubaa8 \ud3ec\ud568)</p> </li> <li> <p>TryApplyFertilizer, TryFertilizeByPlayer</p> </li> <li> <p>CanHarvest/Harvest (+ \ub0b4\ubd80\uc6a9 TryHarvestInternal)</p> </li> </ul> <p>\uc790\ub3d9\ud654 \uc2dc\uc2a4\ud15c\uc740 \uc5ec\uae30 API\ub9cc \ud638\ucd9c\ud558\uba74 \ub418\uace0, FarmBed \ub0b4\ubd80 \uad6c\ud604\uc744 \ubab0\ub77c\ub3c4 \ub428 \u2192 \ud655\uc7a5 \ud3ec\uc778\ud2b8</p>"},{"location":"farming/slotstatemachine/#performance-note","title":"Performance Note","text":"<p>\ud604\uc7ac\ub294 FarmBed.Update()\uc5d0\uc11c \uc2ac\ub86f 8\uac1c Tick.</p> <ul> <li> <p>\uc7a5\uc810: \uad6c\ud604 \uac04\ub2e8, \ub514\ubc84\uadf8 \uc26c\uc6c0</p> </li> <li> <p>\ud655\uc7a5 \uc2dc: FarmBed\uac00 \ub9ce\uc544\uc9c0\uba74 Update \ubd84\uc0b0 \ud638\ucd9c \ube44\uc6a9 \uc99d\uac00 \uac00\ub2a5</p> </li> </ul> <p>\uac1c\uc120 \ubc29\ud5a5:</p> <ul> <li>FarmingManager\uc5d0\uc11c \ubaa8\ub4e0 FarmBed\ub97c \ub4f1\ub85d/\uad00\ub9ac\ud558\uace0, \uc77c\uc815 \uc8fc\uae30(\uc608: 0.2s)\ub85c Tick \ud558\uac70\ub098, \ud65c\uc131 Bed\ub9cc Tick \ud558\ub294 \uad6c\uc870\ub85c \ud655\uc7a5 \uac00\ub2a5</li> </ul>"}]}